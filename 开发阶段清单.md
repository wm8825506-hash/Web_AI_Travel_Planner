# AI 旅行规划师 (AI Travel Planner) 开发阶段清单

## 阶段 0：环境与项目初始化

**目标**：保证项目可以本地运行，前后端联通。

- 配置 PyCharm Web 项目环境（FastAPI + 前端框架，如 React/Vue/Next.js）
- 创建基础目录结构：
  - `app/`：FastAPI 后端服务，包含路由、模型、数据库操作
  - `ai-travel-planner-frontend/`：React 前端页面
  - `shared/`：共用配置，如 API key、常量
- 配置 `.env` 或安全存储服务的 API key（语音识别、地图、LLM）
- 当前目录结构：
  D:\graduate\AI_Travel_Planner
  ├── app/                                # 后端主应用目录
  │   ├── models/                         # 数据模型
  │   │   └── user.py                     # 用户模型
  │   ├── routers/                        # 路由处理
  │   │   ├── auth.py                     # 认证路由 (注册/登录)
  │   │   ├── budget.py                   # 预算路由
  │   │   ├── expense.py                  # 支出路由
  │   │   ├── home.py                     # 主页路由
  │   │   ├── plan.py                     # 行程路由
  │   │   └── speech.py                   # 语音路由
  │   ├── schemas/                        # 数据模式定义
  │   │   ├── budget.py                   # 预算数据模式
  │   │   ├── plan.py                     # 行程数据模式
  │   │   └── user.py                     # 用户数据模式
  │   ├── services/                       # 业务逻辑服务
  │   │   ├── ai_expense_parser.py        # AI 支出解析服务
  │   │   ├── ai_planner.py               # AI 行程规划服务
  │   │   ├── speech_recognizer.py        # 语音识别服务
  │   │   └── supabase_client.py          # Supabase 客户端
  │   ├── config.py                       # 配置文件
  │   ├── db.py                           # 数据库配置
  │   ├── dependencies.py                 # 依赖项
  │   └── main.py                         # 应用入口文件
  ├── ai-travel-planner-frontend/         # 前端应用目录
  │   ├── src/
  │   │   ├── components/                 # 组件目录
  │   │   │   ├── AuthForm.jsx            # 认证表单组件
  │   │   │   ├── ExpenseRecorder.jsx     # 支出记录组件
  │   │   │   ├── Layout.jsx              # 布局组件
  │   │   │   ├── PlanForm.jsx            # 行程规划表单组件
  │   │   │   ├── SpeechInput.jsx         # 语音输入组件
  │   │   │   ├── TripDayCard.jsx         # 行程日组件
  │   │   │   ├── TripMap.jsx             # 行程地图组件
  │   │   │   └── VoiceExpenseInput.jsx   # 语音支出输入组件
  │   │   ├── pages/                      # 页面目录
  │   │   │   ├── BudgetManagement.jsx    # 预算管理页面
  │   │   │   ├── Home.js                 # 主页
  │   │   │   └── TripManagement.jsx      # 行程管理页面
  │   │   ├── api.js                      # API 接口
  │   │   ├── App.js                      # 主应用组件
  │   │   └── ...
  │   └── ...
  ├── .gitignore                          # Git 忽略文件配置
  ├── create_budget_table.sql             # 预算表创建 SQL
  ├── docker-compose.yml                  # Docker 编排配置
  ├── Dockerfile.backend                  # 后端 Docker 配置
  ├── ai-travel-planner-frontend/Dockerfile  # 前端 Docker 配置
  ├── init_supabase_tables.py             # Supabase 表初始化脚本
  ├── requirements.txt                    # 项目依赖列表
  └── 开发阶段清单.md                      # 开发阶段清单文档
- 后端加载： python -m uvicorn app.main:app --reload    
- 前端： npm start

---

## 阶段 1：用户管理与认证

**目标**：实现注册、登录和会话管理，为行程数据存储打基础。

- 集成 Supabase 
  - 注册、登录、登出
  - 会话保持
- 创建用户信息表：
  - 用户 ID、昵称、偏好设置、旅行记录索引
- 测试前端注册登录流程

---

## 阶段 2：语音与文字输入接口

**目标**：用户能通过语音或文字提交旅行需求。

- 前端：
  - 语音录制按钮 + 文本框输入
  - 将音频上传到后端处理
- 后端：
  - 集成科大讯飞API
  - 返回文本结果给前端
- 测试：
  - 语音能正确转文字
  - 支持多轮输入

---

## 阶段 3：AI 行程生成核心

**目标**：将用户输入转化为旅行规划。

- 后端：
  
  - 创建行程生成 API
  
  - 调用阿里云平台的通义千问 LLM API生成：
    
    - 景点路线
    - 交通安排
    - 住宿推荐
    - 餐厅/娱乐推荐
  
  - 输出 JSON 结构：
    
    ```json
    {
      "day_1": [{"type": "景点", "name": "东京塔", "time": "9:00-11:00", "note": "门票500日元"}],
      "budget": {"total": 10000, "transport": 2000}
    }
    ```

- 前端：
  
  - 列表展示每天行程
  - 地图标注景点位置

---

## 阶段 4：地图导航与交互

**目标**：增强可视化体验。

- 集成高德地图 JS API
  - 景点打点
  - 路线规划
- 点击景点查看详情
- 简单路线优化（按时间或距离排序）
- 测试：
  - 地图正确展示行程路线
  - 与行程列表联动

---

## 阶段 5：费用预算与管理

**目标**：AI 生成预算，并支持记录实际支出。

- AI 预算生成：
  - 交通、住宿、餐饮、门票等
- 前端：
  - 支持用户录入实际花费（语音/文字）
  - 显示预算 vs 实际对比
- 后端：
  - 将记录存入数据库
  - 生成旅行总花费报告

---

## 阶段 6：云端行程同步与多设备支持

**目标**：确保数据跨设备可用。

- 行程存储在 Supabase
- 前端：
  - "我的行程"列表
  - 点击行程查看详情
- 自动同步：
  - 新增/修改行程时实时更新
- 测试：
  - 不同设备登录同一账号，数据一致

---

## 阶段 7：UI/UX 优化与可视化增强
**目标**：让 MVP 看起来更专业。

- 行程列表 + 地图结合
- 美观图片和卡片展示景点
- 增加下载或分享行程功能（PDF/链接）